@model configurator_shop.Models.ViewModels.OrderViewModel

@{
    ViewBag.Title = "Ваш заказ";
    Layout = "_Layout";
    int i = 0;
    int totalPrice = 0;
}

<h1 class="text-center text-wrap my-5">Ваш заказ</h1>

<div class="container">
    <div class="row h-100 mb-5">
        <div class="col-12 col-md-9 mb-5 mb-md-0 border-end border-2 border-dark">
            <form id="general-form" asp-controller="Order" asp-action="YourOrder" method="post">
                <div class="border-bottom border-2 border-dark">
                    <h3>Контактные данные</h3>
                    <div class="row mt-4">
                        @if (User.Identity is {IsAuthenticated: true })
                        {
                            <div class="col-12 col-md-6 col-lg-4 mb-4">
                                <label class="form-label" asp-for="FirstName"></label>
                                <input value="@Model.FirstName" class="form-control rounded-pill" placeholder="Ваше имя" disabled>
                                @Html.HiddenFor(m => m.FirstName)
                            </div>
                            <div class="col-12 col-md-6 col-lg-4 mb-4">
                                <label class="form-label" asp-for="LastName"></label>
                                <input value="@Model.LastName" class="form-control rounded-pill" placeholder="Ваша фамилия" disabled>
                                @Html.HiddenFor(m => m.LastName)
                            </div>
                            <div class="col-12 col-md-6 col-lg-4 mb-4">
                                <label class="form-label" asp-for="Email"></label>
                                <input value="@Model.Email" class="form-control rounded-pill" placeholder="info@example.com" disabled>
                                @Html.HiddenFor(m => m.Email)
                            </div>
                            <div class="col-12 col-md-6 col-lg-4 mb-4">
                                <label class="form-label" asp-for="Tel"></label>
                                <input value="@Model.Tel" class="form-control rounded-pill" placeholder="+7 (900) 999-22-11" disabled>
                                @Html.HiddenFor(m => m.Tel)
                            </div>
                        }
                        else
                        {
                            <div class="col-12 col-md-6 col-lg-4 mb-4">
                                <label class="form-label" asp-for="FirstName"></label>
                                <input asp-for="FirstName" class="form-control rounded-pill" placeholder="Ваше имя">
                                <div class="fs-sm text-danger">
                                    @Html.ValidationMessageFor(m => m.FirstName)
                                </div>
                            </div>
                            <div class="col-12 col-md-6 col-lg-4 mb-4">
                                <label class="form-label" asp-for="LastName"></label>
                                <input asp-for="LastName" class="form-control rounded-pill" placeholder="Ваша фамилия">
                                <div class="fs-sm text-danger">
                                    @Html.ValidationMessageFor(m => m.LastName)
                                </div>
                            </div>
                            <div class="col-12 col-md-6 col-lg-4 mb-4">
                                <label class="form-label" asp-for="Email"></label>
                                <input asp-for="Email" class="form-control rounded-pill" placeholder="info@example.com">
                                <div class="fs-sm text-danger">
                                    @Html.ValidationMessageFor(m => m.Email)
                                </div>
                            </div>
                            <div class="col-12 col-md-6 col-lg-4 mb-4">
                                <label class="form-label" asp-for="Tel"></label>
                                <input asp-for="Tel" class="form-control rounded-pill" placeholder="+7 (900) 999-22-11">
                                <div class="fs-sm text-danger">
                                    @Html.ValidationMessageFor(m => m.Tel)
                                </div>
                            </div>
                        }
                    </div>
                </div>
                <div class="mt-4">
                    <h3>Доставка</h3>
                    <div class="row mt-4">
                        <div class="col-12 col-md-6 col-lg-4 mb-4">
                            <label class="form-label" for="city">
                                Город
                            </label>
                            <input asp-for="City" class="form-control rounded-pill" placeholder="Ваш город" id="city">
                            <div class="fs-sm text-danger">
                                @Html.ValidationMessageFor(m => m.City)
                            </div>
                        </div>
                        <div class="col-12 col-md-6 col-lg-4 mb-4">
                            <label class="form-label" for="street">
                                Улица
                            </label>
                            <input asp-for="Street" class="form-control rounded-pill" placeholder="Улица, проспект или т.п." id="street">
                            <div class="fs-sm text-danger">
                                @Html.ValidationMessageFor(m => m.Street)
                            </div>
                        </div>
                        <div class="col-6 col-md-3 col-lg-2 mb-4">
                            <label class="form-label" for="building">
                                Дом
                            </label>
                            <input asp-for="House" class="form-control rounded-pill" placeholder="" id="building">
                            <div class="fs-sm text-danger">
                                @Html.ValidationMessageFor(m => m.House)
                            </div>
                        </div>
                        <div class="col-6 col-md-3 col-lg-2 mb-4">
                            <label class="form-label" for="apartment">
                                Квартира
                            </label>
                            <input asp-for="Apartment" class="form-control rounded-pill" placeholder="" id="apartment">
                            <div class="fs-sm text-danger">
                                @Html.ValidationMessageFor(m => m.Apartment)
                            </div>
                        </div>
                        <div class="col-md-6 d-none d-md-block d-lg-none"></div>
                        <div class="form-check col-6 mb-3">
                            <div class="ms-2">
                                <input class="form-check-input" asp-for="Warranty" id="ch-1">
                                <label class="form-check-label" for="ch-1">
                                    Дополнительная гарантия 1 год
                                </label>
                            </div>
                        </div>
                        <div class="form-check col-6 mb-3">
                            <div class="ms-2">
                                <input class="form-check-input" asp-for="Test" id="ch-2">
                                <label class="form-check-label" for="ch-2">
                                    Тест всех товаров от наших специалистов
                                </label>
                            </div>
                        </div>
                        <div class="form-check col-6 mb-3">
                            <div class="ms-2">
                                <input class="form-check-input" asp-for="CourierCall" id="ch-3">
                                <label class="form-check-label" for="ch-3">
                                    Звонок от курьера за час до доставки
                                </label>
                            </div>
                        </div>
                        <div class="form-check col-6 mb-3">
                            <div class="ms-2">
                                <input class="form-check-input" asp-for="FastDelivery" id="ch-4">
                                <label class="form-check-label" for="ch-4">
                                    Быстрая доставка
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="col-12 col-md-3 gx-0">
            <div class="overflow-scroll custom-scroll" style="overflow-x: hidden !important; max-height: 35vh;">
                @foreach (var product in Model.Cart.Cart)
                {
                    totalPrice += product.Item1.Price * product.Item2;
                    <div class="border-bottom border-1 border-dark fs-sm ms-2 mb-2 d-flex">
                        <div class="mx-2">
                            <span>@(++i)</span>
                        </div>
                        <div class="d-flex flex-column ms-2">
                            <span class="mb-1">@(product.Item1.Name + " - " + product.Item1.Summary)</span>
                            <span class="mb-1">@(product.Item1.Price)₽ - @(product.Item2) шт.</span>
                        </div>
                    </div>
                    
                }
                @Html.HiddenFor(m => m.Cart)
                @Html.HiddenFor(m => m.Cart.Cart)
            </div>

            <div class="my-5 d-flex flex-column justify-content-center align-items-center">
                <h3 class="text-center text-wrap">Итого:   @(totalPrice)₽</h3>
                <button type="submit" form="general-form" class="btn btn-primary fw-bold mt-3">Заказать</button>
            </div>
        </div>
    </div>
</div>